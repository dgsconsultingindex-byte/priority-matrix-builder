<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0969da" />
  <title>PrioBox â€” Focus What Matters</title>
  <link rel="stylesheet" href="style2.css" />
</head>
<body>
  <div id="loading" class="loading-overlay">Loading PrioBox...</div>

  <div class="wrap">
    <header>
      <div class="brand">
        <h1>PrioBox</h1>
        <p>Focus what matters</p>
      </div>
      <div class="header-actions">
        <button id="themeToggle" class="icon-btn" title="Toggle dark mode">ðŸŒ“</button>
      </div>
    </header>

    <div id="appArea" style="display:none">
      <div style="display:flex;justify-content:center;margin:16px 0">
        <div class="view-toggle">
          <button id="viewDaily" class="active">Daily Focus</button>
          <button id="viewTimer">Focus Timer</button>
          <button id="viewMatrix">Full Matrix</button>
        </div>
      </div>

      <!-- Daily View -->
      <div id="dailyView">
        <div class="daily-hero">
          <h2>Today's Focus</h2>
          <p id="dailyDate"></p>
        </div>
        <div id="dailyStats" class="stats-grid">
          <div class="stat-card"><div class="stat-value" id="todayDue">0</div><div class="stat-label">Due Today</div></div>
          <div class="stat-card"><div class="stat-value" id="overdueCount">0</div><div class="stat-label">Overdue</div></div>
          <div class="stat-card"><div class="stat-value" id="upcomingCount">0</div><div class="stat-label">This Week</div></div>
        </div>
        <div class="focus-list" id="dailyTasks"></div>
      </div>

      <!-- Focus Timer View -->
      <div id="timerView" style="display:none">
        <div class="focus-timer-widget">
          <h2>Focus Timer</h2>
          <div class="timer-mode">
            <button id="timerFocus" class="active">Focus (25 min)</button>
            <button id="timerShortBreak">Short Break (5 min)</button>
            <button id="timerLongBreak">Long Break (15 min)</button>
          </div>
          <div class="timer-display" id="timerDisplay">25:00</div>
          <div class="timer-status" id="timerStatus">Ready to focus</div>
          <div class="timer-controls">
            <button id="timerStart">Start</button>
            <button id="timerReset" class="ghost">Reset</button>
          </div>
          <div style="margin-top:24px;padding-top:24px;border-top:1px solid var(--muted)">
            <div style="font-size:0.9rem;color:var(--text-secondary);margin-bottom:8px">
              Sessions completed today: <strong id="sessionsToday">0</strong>
            </div>
          </div>
        </div>
      </div>

      <!-- Matrix View -->
      <div id="matrixView" style="display:none">
        <section class="controls" aria-label="Task controls">
          <input id="taskTitle" type="text" placeholder="Task title (required)" />
          <input id="taskDescription" type="text" placeholder="Description (optional)" />
          <input id="taskDue" type="date" />
          <select id="taskQuadrant">
            <option value="do-first">Do First</option>
            <option value="schedule">Schedule</option>
            <option value="delegate">Delegate</option>
            <option value="eliminate">Eliminate</option>
          </select>
          <button class="btn" id="addBtn">Add Task</button>
          <button class="btn ghost" id="demoBtn">Demo Data</button>
        </section>

        <section class="matrix" aria-label="Priority matrix">
          <div class="quadrant do-first" data-q="do-first">
            <div class="quad-head">
              <div><div class="quad-title">Do First</div><div class="quad-sub">Urgent & Important</div></div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
                <div id="do-first-count">(0/0 done)</div>
                <div class="progress-bar"><div id="do-first-fill" class="progress-fill" style="width:0%;"></div></div>
              </div>
            </div>
            <div class="tasks" id="do-first-tasks"></div>
          </div>
          <div class="quadrant schedule" data-q="schedule">
            <div class="quad-head">
              <div><div class="quad-title">Schedule</div><div class="quad-sub">Not Urgent but Important</div></div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
                <div id="schedule-count">(0/0 done)</div>
                <div class="progress-bar"><div id="schedule-fill" class="progress-fill"></div></div>
              </div>
            </div>
            <div class="tasks" id="schedule-tasks"></div>
          </div>
          <div class="quadrant delegate" data-q="delegate">
            <div class="quad-head">
              <div><div class="quad-title">Delegate</div><div class="quad-sub">Urgent but Not Important</div></div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
                <div id="delegate-count">(0/0 done)</div>
                <div class="progress-bar"><div id="delegate-fill" class="progress-fill"></div></div>
              </div>
            </div>
            <div class="tasks" id="delegate-tasks"></div>
          </div>
          <div class="quadrant eliminate" data-q="eliminate">
            <div class="quad-head">
              <div><div class="quad-title">Eliminate</div><div class="quad-sub">Not Urgent & Not Important</div></div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
                <div id="eliminate-count">(0/0 done)</div>
                <div class="progress-bar"><div id="eliminate-fill" class="progress-fill"></div></div>
              </div>
            </div>
            <div class="tasks" id="eliminate-tasks"></div>
          </div>
        </section>
      </div>

      <footer>Â© 2025 PrioBox â€” Built by DGS Consulting</footer>
    </div>
  </div>

  <script>
    (() => {
      const loading = document.getElementById('loading');
      const appArea = document.getElementById('appArea');

      // Theme toggle
      const themeToggle = document.getElementById('themeToggle');
      themeToggle.addEventListener('click', () => {
        if(document.documentElement.getAttribute('data-theme')==='dark'){
          document.documentElement.removeAttribute('data-theme');
        } else {document.documentElement.setAttribute('data-theme','dark');}
      });

      // Views
      const dailyView = document.getElementById('dailyView');
      const timerView = document.getElementById('timerView');
      const matrixView = document.getElementById('matrixView');
      document.getElementById('viewDaily').addEventListener('click',()=>{dailyView.style.display='block';timerView.style.display='none';matrixView.style.display='none';setActiveView('viewDaily');});
      document.getElementById('viewTimer').addEventListener('click',()=>{dailyView.style.display='none';timerView.style.display='block';matrixView.style.display='none';setActiveView('viewTimer');});
      document.getElementById('viewMatrix').addEventListener('click',()=>{dailyView.style.display='none';timerView.style.display='none';matrixView.style.display='block';setActiveView('viewMatrix');});
      function setActiveView(id){document.querySelectorAll('.view-toggle button').forEach(b=>b.classList.remove('active'));document.getElementById(id).classList.add('active');}

      // Task storage
      let tasks=[];
      function addTask(title,desc,due,quad){
        const task={id:Date.now(),title,desc,due,done:false,quad};
        tasks.push(task);renderMatrix();renderDaily();
      }

      // Demo data
      document.getElementById('demoBtn').addEventListener('click',()=>{
        tasks=[
          {id:1,title:'Finish report',desc:'Q4 report',due:'2025-11-24',done:false,quad:'do-first'},
          {id:2,title:'Call supplier',desc:'Schedule meeting',due:'2025-11-25',done:false,quad:'schedule'},
          {id:3,title:'Delegate emails',desc:'Forward to assistant',due:'2025-11-24',done:true,quad:'delegate'},
          {id:4,title:'Clean inbox',desc:'Delete spam',due:'2025-11-26',done:false,quad:'eliminate'}
        ];
        renderMatrix();renderDaily();
      });

      document.getElementById('addBtn').addEventListener('click',()=>{
        const t=document.getElementById('taskTitle').value;
        const d=document.getElementById('taskDescription').value;
        const due=document.getElementById('taskDue').value;
        const q=document.getElementById('taskQuadrant').value;
        if(t){addTask(t,due,due,q);document.getElementById('taskTitle').value='';}
      });

      function renderMatrix(){
        ['do-first','schedule','delegate','eliminate'].forEach(q=>{
          const container=document.getElementById(q+'-tasks');
          container.innerHTML='';
          const qTasks=tasks.filter(t=>t.quad===q);
          qTasks.forEach(t=>{
            const div=document.createElement('div');
            div.className='task-item'+(t.done?' done':'');
            div.textContent=t.title;
            div.addEventListener('click',()=>{t.done=!t.done;renderMatrix();renderDaily();});
            container.appendChild(div);
          });
          const countDone=qTasks.filter(t=>t.done).length;
          const countElem=document.getElementById(q+'-count');
          countElem.textContent=`(${countDone}/${qTasks.length} done)`;
          const fillElem=document.getElementById(q+'-fill');
          fillElem.style.width=qTasks.length?Math.round(countDone/qTasks.length*100)+'%':'0';
        });
      }

      function renderDaily(){
        const today=new Date().toISOString().split('T')[0];
        document.getElementById('dailyDate').textContent=today;
        const todayTasks=tasks.filter(t=>t.due===today);
        document.getElementById('todayDue').textContent=todayTasks.length;
        const overdue=tasks.filter(t=>t.due<today && !t.done).length;
        document.getElementById('overdueCount').textContent=overdue;
        const upcoming=tasks.filter(t=>t.due>today && !t.done).length;
        document.getElementById('upcomingCount').textContent=upcoming;
        const dailyTasks=document.getElementById('dailyTasks');
        dailyTasks.innerHTML='';
        todayTasks.forEach(t=>{
          const div=document.createElement('div');
          div.className='task-item'+(t.done?' done':'');
          div.textContent=t.title;
          div.addEventListener('click',()=>{t.done=!t.done;renderDaily();renderMatrix();});
          dailyTasks.appendChild(div);
        });
      }

      // Focus Timer
      let timer=null;
      let timerSeconds=25*60;
      let sessionsToday=0;
      let timerInterval=null;
      const timerDisplay=document.getElementById('timerDisplay');
      const timerStatus=document.getElementById('timerStatus');
      function updateTimerDisplay(){
        const m=Math.floor(timerSeconds/60).toString().padStart(2,'0');
        const s=(timerSeconds%60).toString().padStart(2,'0');
        timerDisplay.textContent=`${m}:${s}`;
      }
      function startTimer(){
        if(timerInterval)return;
        timerStatus.textContent='Running...';
        timerInterval=setInterval(()=>{
          timerSeconds--;
          updateTimerDisplay();
          if(timerSeconds<=0){clearInterval(timerInterval);timerInterval=null;sessionsToday++;document.getElementById('sessionsToday').textContent=sessionsToday;timerStatus.textContent='Done';}
        },1000);
      }
      function resetTimer(){
        clearInterval(timerInterval);timerInterval=null;timerSeconds=25*60;updateTimerDisplay();timerStatus.textContent='Ready';
      }
      document.getElementById('timerStart').addEventListener('click',startTimer);
      document.getElementById('timerReset').addEventListener('click',resetTimer);

      // Init
      setTimeout(()=>{
        loading.style.display='none';
        appArea.style.display='block';
      },500);

    })();
  </script>
</body>
</html>
