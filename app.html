<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PrioBox â€” Focus What Matters</title>
  <meta name="description" content="PrioBox â€” Eisenhower priority matrix with due dates, labels, calendar export and cloud sync." />
  <style>
    :root{
      --bg: #f6f8fa;
      --panel: #ffffff;
      --panel-hover: #fafbfc;
      --border: #d0d7de;
      --muted: #e1e4e8;
      --text: #1f2328;
      --text-secondary: #57606a;
      --accent-1: #0969da;
      --accent-2: #0550ae;
      --accent-light: #ddf4ff;
      --accent-border: #54aeff;
      --on-time: #1a7f37;
      --on-time-bg: #dafbe1;
      --approach: #bf8700;
      --approach-bg: #fff8c5;
      --overdue: #cf222e;
      --overdue-bg: #ffebe9;
      --tag-client: #0969da;
      --tag-client-bg: #ddf4ff;
      --tag-personal: #8250df;
      --tag-personal-bg: #fbefff;
      --tag-urgent: #cf222e;
      --tag-urgent-bg: #ffebe9;
      --shadow-sm: rgba(27,31,36,0.04);
      --shadow-md: rgba(27,31,36,0.08);
      --shadow-lg: rgba(27,31,36,0.12);
      --radius: 12px;
      --radius-sm: 8px;
      --radius-lg: 16px;
      --gap: 1rem;
      --ui-h: 44px;
      --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans",Helvetica,Arial,sans-serif;color:var(--text);background:var(--bg);line-height:1.5}
    .wrap{max-width:1200px;margin:0 auto;padding:24px}
    
    header{display:flex;justify-content:space-between;align-items:center;gap:16px;margin-bottom:32px;flex-wrap:wrap}
    .brand{display:flex;gap:14px;align-items:center}
    .brand img{height:40px;width:auto}
    
    .loading-overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.95);z-index:9999;font-size:1.1rem;color:var(--text);transition:opacity .3s ease}
    .loading-hidden{opacity:0;pointer-events:none}

    .view-toggle{display:flex;gap:4px;background:var(--panel);padding:4px;border-radius:var(--radius);box-shadow:0 2px 8px var(--shadow-sm);border:1px solid var(--border)}
    .view-toggle button{padding:10px 20px;border:none;background:transparent;border-radius:var(--radius-sm);cursor:pointer;font-weight:600;font-size:0.95rem;color:var(--text-secondary);transition:var(--transition)}
    .view-toggle button:hover{background:var(--panel-hover);color:var(--text)}
    .view-toggle button.active{background:var(--accent-1);color:white;box-shadow:0 2px 4px var(--shadow-sm)}

    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;margin:20px 0}
    .stat-card{background:var(--panel);padding:24px;border-radius:var(--radius);box-shadow:0 2px 8px var(--shadow-sm);border:1px solid var(--border);display:flex;flex-direction:column;gap:12px;transition:var(--transition)}
    .stat-card:hover{box-shadow:0 4px 16px var(--shadow-md);transform:translateY(-2px)}
    .stat-value{font-size:2.5rem;font-weight:700;color:var(--accent-1);line-height:1}
    .stat-label{font-size:0.95rem;color:var(--text-secondary);font-weight:500;text-transform:uppercase;letter-spacing:0.05em}
    .stat-trend{font-size:0.9rem;color:var(--text-secondary)}
    .chart-bar{height:6px;background:var(--muted);border-radius:999px;overflow:hidden;margin-top:8px}
    .chart-fill{height:100%;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));transition:width .4s cubic-bezier(0.4, 0, 0.2, 1)}

    .daily-hero{background:linear-gradient(135deg,var(--accent-1),var(--accent-2));color:white;padding:32px;border-radius:var(--radius-lg);margin:20px 0;box-shadow:0 8px 24px var(--shadow-lg)}
    .daily-hero h2{margin:0 0 8px 0;font-size:2rem;font-weight:700;letter-spacing:-0.02em}
    .daily-hero p{margin:0;opacity:0.95;font-size:1.1rem}
    .focus-list{display:flex;flex-direction:column;gap:12px;margin-top:20px}

    .subtasks{margin-top:12px;padding-left:12px;border-left:2px solid var(--border)}
    .subtask{display:flex;gap:10px;align-items:center;padding:8px 0;font-size:0.9rem;color:var(--text-secondary)}
    .subtask input[type="checkbox"]{cursor:pointer;width:16px;height:16px;accent-color:var(--accent-1)}
    .subtask.completed{opacity:0.6;text-decoration:line-through}
    .subtask-add{color:var(--accent-1);cursor:pointer;font-size:0.9rem;margin-top:8px;padding:8px 0;font-weight:600;transition:var(--transition)}
    .subtask-add:hover{color:var(--accent-2)}

    .auth-sheet-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.4);display:none;z-index:120;transition:opacity .3s ease}
    .auth-sheet-backdrop.show{display:block;opacity:1}
    .auth-sheet{position:fixed;left:50%;transform:translateX(-50%);bottom:-100%;width:100%;max-width:500px;background:var(--panel);border-radius:var(--radius-lg) var(--radius-lg) 0 0;box-shadow:0 -8px 32px var(--shadow-lg);padding:32px;z-index:130;transition:bottom .4s cubic-bezier(.2,.9,.3,1);border:1px solid var(--border)}
    .auth-sheet.show{bottom:0}
    .auth-top{display:flex;gap:16px;align-items:center;margin-bottom:20px}
    .auth-top img{height:48px;width:auto}
    .auth-title{margin:0;font-size:1.5rem;font-weight:700}
    .auth-row{display:flex;gap:12px;margin-top:16px;flex-wrap:wrap}
    .auth-row input{flex:1;min-width:200px;height:44px;padding:0 14px;border-radius:var(--radius-sm);border:1px solid var(--border);transition:var(--transition)}
    .auth-row input:focus{outline:none;border-color:var(--accent-1);box-shadow:0 0 0 3px var(--accent-light)}
    .auth-row button{height:44px;padding:0 24px;border-radius:var(--radius-sm);border:none;background:linear-gradient(135deg,var(--accent-1),var(--accent-2));color:#fff;font-weight:600;cursor:pointer;transition:var(--transition)}
    .auth-row button:hover{transform:translateY(-1px);box-shadow:0 4px 12px var(--shadow-md)}
    .auth-note{font-size:0.9rem;color:var(--text-secondary);margin-top:12px}

    .controls{display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:center;margin:20px 0}
    .controls input[type="text"],.controls input[type="date"],.controls select{height:var(--ui-h);padding:0 14px;border-radius:var(--radius-sm);border:1px solid var(--border);background:var(--panel);font-size:0.95rem;box-shadow:0 2px 4px var(--shadow-sm);min-width:160px;transition:var(--transition)}
    .controls input:focus,.controls select:focus{outline:none;border-color:var(--accent-1);box-shadow:0 0 0 3px var(--accent-light)}
    .controls .btn{height:var(--ui-h);padding:0 20px;border-radius:var(--radius-sm);border:none;background:linear-gradient(135deg,var(--accent-1),var(--accent-2));color:white;font-weight:600;cursor:pointer;white-space:nowrap;transition:var(--transition);box-shadow:0 2px 8px var(--shadow-sm)}
    .controls .btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px var(--shadow-md)}
    .controls .btn.ghost{background:var(--panel);border:1px solid var(--border);color:var(--text);box-shadow:0 2px 4px var(--shadow-sm)}
    .controls .btn.ghost:hover{background:var(--panel-hover);border-color:var(--accent-1)}

    .search-row{display:flex;justify-content:center;padding:8px 0}
    .search-row input{width:560px;max-width:100%;height:44px;padding:0 16px;border-radius:var(--radius);border:1px solid var(--border);background:var(--panel);font-size:0.95rem;transition:var(--transition)}
    .search-row input:focus{outline:none;border-color:var(--accent-1);box-shadow:0 0 0 3px var(--accent-light)}

    .filters{display:flex;gap:12px;align-items:center;justify-content:center;margin-bottom:8px;flex-wrap:wrap;text-align:center}

    .matrix{display:grid;grid-template-columns:1fr 1fr;gap:20px}
    .quadrant{background:var(--panel);border-radius:var(--radius-lg);padding:24px;box-shadow:0 2px 8px var(--shadow-sm);border:1px solid var(--border);min-height:300px;display:flex;flex-direction:column;transition:var(--transition)}
    .quadrant:hover{box-shadow:0 4px 16px var(--shadow-md)}
    .quad-head{display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:wrap;margin-bottom:16px;padding-bottom:16px;border-bottom:2px solid var(--muted)}
    .quad-title{font-weight:700;font-size:1.1rem;letter-spacing:-0.01em}
    .quad-sub{font-size:0.9rem;color:var(--text-secondary);margin-top:4px;font-weight:500}
    .progress-bar{width:140px;height:6px;background:var(--muted);border-radius:999px;overflow:hidden}
    .progress-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));transition:width .4s cubic-bezier(0.4, 0, 0.2, 1)}

    .tasks{margin-top:12px;display:flex;flex-direction:column;gap:12px;overflow:auto;padding-bottom:8px;flex:1}

    .task{display:flex;gap:12px;align-items:flex-start;background:var(--panel);padding:16px;border-radius:var(--radius);border:1px solid var(--border);cursor:grab;transition:var(--transition)}
    .task:hover{transform:translateY(-2px);box-shadow:0 4px 12px var(--shadow-md);border-color:var(--accent-border)}
    .task-left{flex:1;min-width:0}
    .task-title{margin:0;font-weight:600;word-wrap:break-word;font-size:0.95rem;color:var(--text)}
    .task-desc{margin-top:6px;color:var(--text-secondary);font-size:0.9rem;word-wrap:break-word;line-height:1.5}
    .task-due{margin-top:10px;display:inline-block;padding:6px 12px;border-radius:var(--radius-sm);font-weight:600;color:white;font-size:0.85rem}
    .task-controls{display:flex;gap:6px;align-items:center;flex-shrink:0}
    .small-btn{background:transparent;border:none;cursor:pointer;padding:8px;border-radius:var(--radius-sm);font-size:15px;color:var(--text-secondary);transition:var(--transition)}
    .small-btn:hover{background:var(--panel-hover);color:var(--text)}
    .task.completed{opacity:0.5}
    .task.completed .task-title{text-decoration:line-through}

    .due-on-time{border-left:3px solid var(--on-time);background:var(--on-time-bg)}
    .due-approach{border-left:3px solid var(--approach);background:var(--approach-bg)}
    .due-overdue{border-left:3px solid var(--overdue);background:var(--overdue-bg)}

    .tag{display:inline-block;padding:4px 10px;border-radius:var(--radius-sm);font-weight:600;font-size:0.75rem;margin-left:8px}
    .tag-client{background:var(--tag-client-bg);color:var(--tag-client)}
    .tag-personal{background:var(--tag-personal-bg);color:var(--tag-personal)}
    .tag-urgent{background:var(--tag-urgent-bg);color:var(--tag-urgent)}

    .panel-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.4);display:none;z-index:120;transition:opacity .3s ease}
    .panel-backdrop.show{display:block;opacity:1}
    .panel{position:fixed;right:0;top:0;height:100%;width:480px;max-width:94%;background:var(--panel);box-shadow:-8px 0 32px var(--shadow-lg);transform:translateX(108%);transition:transform .3s cubic-bezier(0.4, 0, 0.2, 1);z-index:130;padding:32px;display:flex;flex-direction:column;gap:20px;overflow-y:auto;border-left:1px solid var(--border)}
    .panel.show{transform:translateX(0)}
    .panel h3{margin:0;font-size:1.5rem;font-weight:700}
    .panel h4{margin:16px 0 8px 0;font-size:1rem;font-weight:600;color:var(--text-secondary)}
    .panel input[type="text"],.panel input[type="date"],.panel select,.panel textarea{width:100%;padding:12px 14px;border-radius:var(--radius-sm);border:1px solid var(--border);background:var(--panel);box-sizing:border-box;font-size:0.95rem;transition:var(--transition)}
    .panel input:focus,.panel select:focus,.panel textarea:focus{outline:none;border-color:var(--accent-1);box-shadow:0 0 0 3px var(--accent-light)}
    .panel textarea{min-height:100px;resize:vertical;font-family:inherit;line-height:1.5}
    .panel .row{display:flex;gap:12px;flex-wrap:wrap}
    .panel .row > *{flex:1;min-width:180px}

    .onboard{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:140;pointer-events:none;opacity:0;background:rgba(0,0,0,0.4);transition:opacity .3s ease}
    .onboard.show{pointer-events:auto;opacity:1}
    .onboard-card{background:var(--panel);padding:40px;border-radius:var(--radius-lg);width:min(600px,94%);box-shadow:0 20px 60px var(--shadow-lg);max-height:90vh;overflow-y:auto;border:1px solid var(--border)}
    .onboard-card h2{margin:0 0 20px 0;font-size:1.75rem;font-weight:700}
    .onboard-card p{margin:16px 0;color:var(--text-secondary);line-height:1.6}
    .onboard-card ul,.onboard-card ol{line-height:1.8;color:var(--text-secondary);padding-left:24px}
    .onboard-card strong{color:var(--text)}

    footer{text-align:center;color:var(--text-secondary);margin-top:32px;font-size:0.9rem;padding:20px}

    @media(max-width:900px){
      .matrix{grid-template-columns:1fr}
      .controls input[type="text"]{min-width:130px}
      .panel{width:100%}
      header{justify-content:center}
      .stats-grid{grid-template-columns:1fr}
      .wrap{padding:16px}
    }
  </style>
</head>
<body>
  <div id="loading" class="loading-overlay">Loading your priorities...</div>

  <div class="wrap" id="root">
    <header>
      <div class="brand">
        <img src="images/PrioBox - Primary.png" alt="PrioBox" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'" />
        <svg style="display:none;height:40px;width:auto" viewBox="0 0 200 50" xmlns="http://www.w3.org/2000/svg">
          <rect x="5" y="10" width="15" height="15" rx="3" fill="#0969da"/>
          <rect x="25" y="10" width="15" height="15" rx="3" fill="#0550ae"/>
          <rect x="5" y="30" width="15" height="15" rx="3" fill="#54aeff"/>
          <rect x="25" y="30" width="15" height="15" rx="3" fill="#ddf4ff"/>
          <text x="50" y="35" font-family="system-ui,-apple-system,sans-serif" font-size="24" font-weight="700" fill="#1f2328">PrioBox</text>
        </svg>
      </div>
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <button id="signOutBtn" style="display:none;height:40px;padding:8px 12px;border-radius:10px;background:var(--panel);border:1px solid var(--border);cursor:pointer;transition:var(--transition)">Sign Out</button>
        <button id="accountBtn" style="display:none;height:40px;padding:8px 12px;border-radius:10px;background:var(--panel);border:1px solid var(--border);cursor:pointer;transition:var(--transition)">Account</button>
      </div>
    </header>

    <div id="authBackdrop" class="auth-sheet-backdrop"></div>
    <div id="authSheet" class="auth-sheet" role="dialog" aria-modal="true" aria-labelledby="authTitle">
      <div class="auth-top">
        <img src="images/PrioBox - Icon.png" alt="PrioBox" />
        <div>
          <h2 id="authTitle" class="auth-title">Welcome to PrioBox</h2>
          <div class="auth-note">Cloud sync available - sign in optional (works offline too!)</div>
        </div>
      </div>
      <div class="auth-row">
        <input id="authEmail" type="email" placeholder="you@example.com" aria-label="Email" />
        <button id="authSend">Send Magic Link</button>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:16px;flex-wrap:wrap;gap:12px">
        <div style="font-size:0.9rem;color:var(--text-secondary)">No password needed</div>
        <button id="authClose" style="background:transparent;border:none;color:var(--accent-1);cursor:pointer;font-weight:600;padding:8px">Continue Without Sign In</button>
      </div>
    </div>

    <div id="appArea" style="display:none">
      <div style="display:flex;justify-content:center;margin:16px 0">
        <div class="view-toggle">
          <button id="viewDaily" class="active">Daily Focus</button>
          <button id="viewMatrix">Full Matrix</button>
          <button id="viewStats">Analytics</button>
        </div>
      </div>

      <div id="dailyView">
        <div class="daily-hero">
          <h2>Today's Focus</h2>
          <p id="dailyDate"></p>
        </div>
        <div id="dailyStats" class="stats-grid" style="grid-template-columns:repeat(auto-fit,minmax(180px,1fr))">
          <div class="stat-card">
            <div class="stat-value" id="todayDue">0</div>
            <div class="stat-label">Due Today</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="overdueCount">0</div>
            <div class="stat-label">Overdue</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="upcomingCount">0</div>
            <div class="stat-label">This Week</div>
          </div>
        </div>
        <div class="focus-list" id="dailyTasks"></div>
      </div>

      <div id="statsView" style="display:none">
        <h2 style="text-align:center;margin:16px 0">Your Productivity Analytics</h2>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value" id="totalTasks">0</div>
            <div class="stat-label">Total Tasks</div>
            <div class="stat-trend" id="completionRate"></div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="completedTasks">0</div>
            <div class="stat-label">Completed</div>
            <div class="chart-bar"><div class="chart-fill" id="completedBar"></div></div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="activeTasks">0</div>
            <div class="stat-label">In Progress</div>
            <div class="chart-bar"><div class="chart-fill" id="activeBar"></div></div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="overdueStats">0</div>
            <div class="stat-label">Overdue Items</div>
            <div class="stat-trend">Need attention</div>
          </div>
        </div>
        <h3 style="margin:24px 0 12px 0">Focus Distribution</h3>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">Do First</div>
            <div class="stat-value" style="font-size:1.5rem" id="doFirstStat">0</div>
            <div class="chart-bar"><div class="chart-fill" id="doFirstBar"></div></div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Schedule</div>
            <div class="stat-value" style="font-size:1.5rem" id="scheduleStat">0</div>
            <div class="chart-bar"><div class="chart-fill" id="scheduleBar"></div></div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Delegate</div>
            <div class="stat-value" style="font-size:1.5rem" id="delegateStat">0</div>
            <div class="chart-bar"><div class="chart-fill" id="delegateBar"></div></div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Eliminate</div>
            <div class="stat-value" style="font-size:1.5rem" id="eliminateStat">0</div>
            <div class="chart-bar"><div class="chart-fill" id="eliminateBar"></div></div>
          </div>
        </div>
        <div style="background:var(--panel);padding:20px;border-radius:var(--radius);margin-top:20px;box-shadow:0 8px 20px var(--shadow-sm);border:1px solid var(--border)">
          <h3>Insights</h3>
          <ul id="insightsList" style="line-height:1.8;color:var(--text-secondary)"></ul>
        </div>
      </div>

      <div id="matrixView" style="display:none">
        <section class="controls" aria-label="Task controls">
          <input id="taskTitle" type="text" placeholder="Task title (required)" />
          <input id="taskDescription" type="text" placeholder="Description (optional)" />
          <input id="taskDue" type="date" />
          <select id="taskQuadrant">
            <option value="do-first">Do First</option>
            <option value="schedule">Schedule</option>
        <option value="delegate">Delegate</option>
        <option value="eliminate">Eliminate</option>
      </select>
    </div>
    <div class="row">
      <select id="pLabel">
        <option value="">No label</option>
        <option value="client">Client</option>
        <option value="personal">Personal</option>
        <option value="urgent">Urgent</option>
      </select>
      <label style="display:flex;align-items:center;gap:8px;padding:8px"><input id="pCompleted" type="checkbox"> Completed</label>
    </div>
    <div class="row">
      <textarea id="pDesc" placeholder="Description"></textarea>
    </div>

    <h4>Subtasks</h4>
    <div id="subtasksList"></div>
    <div class="subtask-add" id="addSubtaskBtn">+ Add subtask</div>

    <div style="display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap;margin-top:12px">
      <button id="panelCancel" class="btn ghost">Cancel</button>
      <button id="panelSave" class="btn">Save</button>
    </div>

    <hr style="border:none;border-top:1px solid var(--border);margin:12px 0" />
    <div style="display:flex;gap:8px;flex-direction:column">
      <button id="addToCalendarBtn" class="btn ghost">Open Google Calendar</button>
      <button id="downloadICSBtn" class="btn ghost">Download .ics</button>
      <button id="deleteFromPanelBtn" class="btn ghost" style="color:var(--overdue)">Delete Task</button>
    </div>
  </aside>

  <div id="onboard" class="onboard" aria-hidden="true">
    <div class="onboard-card">
      <h2>Welcome to PrioBox</h2>
      <p><strong>New Features:</strong></p>
      <ul style="line-height:1.8">
        <li><strong>Daily Focus</strong> - See today's priorities at a glance</li>
        <li><strong>Analytics</strong> - Track your productivity and completion rates</li>
        <li><strong>Subtasks</strong> - Break down big tasks into manageable steps</li>
        <li><strong>Smart Insights</strong> - Get personalized productivity tips</li>
      </ul>
      <p style="margin-top:12px"><strong>Quick Tips:</strong></p>
      <ol style="line-height:1.8">
        <li>Start with Daily Focus to see what needs attention today</li>
        <li>Add subtasks to complex items for better tracking</li>
        <li>Check Analytics weekly to see your progress trends</li>
      </ol>
      <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:16px;flex-wrap:wrap">
        <button id="onboardSkip" class="btn ghost">Skip</button>
        <button id="onboardDone" class="btn">Got it!</button>
      </div>
    </div>
  </div>

  <input id="importFileInput" type="file" accept="application/json" style="display:none" />

  <script>
    const STORAGE_KEY = 'priobox_tasks';
    const PREFS_KEY = 'priobox_prefs';
    
    let tasks = {};
    let prefs = { showCompleted: true, theme: 'light', currentView: 'daily' };
    let editingId = null;
    let dragged = null;
    const quadrants = ['do-first','schedule','delegate','eliminate'];

    function loadFromStorage() {
      try {
        const rawTasks = localStorage.getItem(STORAGE_KEY);
        const rawPrefs = localStorage.getItem(PREFS_KEY);
        if (rawTasks) {
          const data = JSON.parse(rawTasks);
          tasks = data.tasks || {};
        }
        if (rawPrefs) {
          prefs = { ...prefs, ...JSON.parse(rawPrefs) };
        }
      } catch(e) {
        console.warn('Could not load from localStorage:', e);
      }
    }

    function saveToStorage() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify({ tasks }));
        localStorage.setItem(PREFS_KEY, JSON.stringify(prefs));
      } catch(e) {
        console.warn('Could not save to localStorage:', e);
      }
    }

    const loadingEl = document.getElementById('loading');
    const authBackdrop = document.getElementById('authBackdrop');
    const authSheet = document.getElementById('authSheet');
    const authEmail = document.getElementById('authEmail');
    const authSend = document.getElementById('authSend');
    const authClose = document.getElementById('authClose');
    const appArea = document.getElementById('appArea');
    const viewDaily = document.getElementById('viewDaily');
    const viewMatrix = document.getElementById('viewMatrix');
    const viewStats = document.getElementById('viewStats');
    const dailyView = document.getElementById('dailyView');
    const matrixView = document.getElementById('matrixView');
    const statsView = document.getElementById('statsView');
    const addBtn = document.getElementById('addBtn');
    const clearBtn = document.getElementById('clearBtn');
    const demoBtn = document.getElementById('demoBtn');
    const taskTitle = document.getElementById('taskTitle');
    const taskDesc = document.getElementById('taskDescription');
    const taskDue = document.getElementById('taskDue');
    const taskQuadrant = document.getElementById('taskQuadrant');
    const taskLabel = document.getElementById('taskLabel');
    const searchInput = document.getElementById('searchInput');
    const toggleCompletedBtn = document.getElementById('toggleCompletedBtn');
    const signOutBtn = document.getElementById('signOutBtn');
    const accountBtn = document.getElementById('accountBtn');
    const exportBtn = document.getElementById('exportBtn');
    const importBtn = document.getElementById('importBtn');
    const importFileInput = document.getElementById('importFileInput');
    const panelBackdrop = document.getElementById('panelBackdrop');
    const slidePanel = document.getElementById('slidePanel');
    const pTitle = document.getElementById('pTitle');
    const pDesc = document.getElementById('pDesc');
    const pDue = document.getElementById('pDue');
    const pQuadrant = document.getElementById('pQuadrant');
    const pLabel = document.getElementById('pLabel');
    const pCompleted = document.getElementById('pCompleted');
    const panelSave = document.getElementById('panelSave');
    const panelCancel = document.getElementById('panelCancel');
    const subtasksList = document.getElementById('subtasksList');
    const addSubtaskBtn = document.getElementById('addSubtaskBtn');
    const addToCalendarBtn = document.getElementById('addToCalendarBtn');
    const downloadICSBtn = document.getElementById('downloadICSBtn');
    const deleteFromPanelBtn = document.getElementById('deleteFromPanelBtn');
    const onboard = document.getElementById('onboard');
    const onboardDone = document.getElementById('onboardDone');
    const onboardSkip = document.getElementById('onboardSkip');

    function uid(){ return `t-${Date.now()}-${Math.floor(Math.random()*9000)}`; }
    function fmtISO(v){ 
      if(!v) return ''; 
      try { 
        const d = new Date(v);
        return d.toISOString().slice(0,10); 
      } catch { 
        return v 
      } 
    }
    function escapeHtml(s){ 
      if(!s) return ''; 
      const div = document.createElement('div');
      div.textContent = s;
      return div.innerHTML;
    }
    function computeUrgencyClass(d){
      if (!d) return '';
      const today = new Date(); 
      today.setHours(0,0,0,0);
      const dd = new Date(d); 
      dd.setHours(0,0,0,0);
      const diff = Math.round((dd - today) / (1000*60*60*24));
      if (diff < 0) return 'due-overdue';
      if (diff <= 2) return 'due-approach';
      return 'due-on-time';
    }

    function getDaysDiff(dateStr) {
      if (!dateStr) return null;
      const today = new Date();
      today.setHours(0,0,0,0);
      const date = new Date(dateStr);
      date.setHours(0,0,0,0);
      return Math.round((date - today) / (1000*60*60*24));
    }

    function switchView(view) {
      prefs.currentView = view;
      saveToStorage();
      [viewDaily, viewMatrix, viewStats].forEach(btn => btn.classList.remove('active'));
      dailyView.style.display = 'none';
      matrixView.style.display = 'none';
      statsView.style.display = 'none';

      if (view === 'daily') {
        viewDaily.classList.add('active');
        dailyView.style.display = 'block';
        renderDailyView();
      } else if (view === 'matrix') {
        viewMatrix.classList.add('active');
        matrixView.style.display = 'block';
        render();
      } else if (view === 'stats') {
        viewStats.classList.add('active');
        statsView.style.display = 'block';
        renderStats();
      }
    }

    viewDaily.addEventListener('click', () => switchView('daily'));
    viewMatrix.addEventListener('click', () => switchView('matrix'));
    viewStats.addEventListener('click', () => switchView('stats'));

    function renderDailyView() {
      const today = new Date();
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      document.getElementById('dailyDate').textContent = today.toLocaleDateString('en-US', options);

      const allTasks = Object.values(tasks);
      const todayTasks = allTasks.filter(t => {
        const diff = getDaysDiff(t.due);
        return diff === 0 && !t.completed;
      });
      const overdueTasks = allTasks.filter(t => {
        const diff = getDaysDiff(t.due);
        return diff !== null && diff < 0 && !t.completed;
      });
      const upcomingTasks = allTasks.filter(t => {
        const diff = getDaysDiff(t.due);
        return diff !== null && diff > 0 && diff <= 7 && !t.completed;
      });

      document.getElementById('todayDue').textContent = todayTasks.length;
      document.getElementById('overdueCount').textContent = overdueTasks.length;
      document.getElementById('upcomingCount').textContent = upcomingTasks.length;

      const dailyTasksContainer = document.getElementById('dailyTasks');
      dailyTasksContainer.innerHTML = '';

      if (overdueTasks.length > 0) {
        const section = document.createElement('div');
        section.innerHTML = '<h3 style="color:var(--overdue);margin:16px 0 8px 0">Overdue</h3>';
        dailyTasksContainer.appendChild(section);
        overdueTasks.sort((a,b) => new Date(a.due) - new Date(b.due)).forEach(t => {
          dailyTasksContainer.appendChild(createTaskNode(t));
        });
      }

      if (todayTasks.length > 0) {
        const section = document.createElement('div');
        section.innerHTML = '<h3 style="color:var(--accent-1);margin:16px 0 8px 0">Due Today</h3>';
        dailyTasksContainer.appendChild(section);
        todayTasks.forEach(t => {
          dailyTasksContainer.appendChild(createTaskNode(t));
        });
      }

      if (upcomingTasks.length > 0) {
        const section = document.createElement('div');
        section.innerHTML = '<h3 style="color:var(--approach);margin:16px 0 8px 0">This Week</h3>';
        dailyTasksContainer.appendChild(section);
        upcomingTasks.sort((a,b) => new Date(a.due) - new Date(b.due)).forEach(t => {
          dailyTasksContainer.appendChild(createTaskNode(t));
        });
      }

      if (overdueTasks.length === 0 && todayTasks.length === 0 && upcomingTasks.length === 0) {
        dailyTasksContainer.innerHTML = '<div style="text-align:center;padding:40px;color:var(--text-secondary)">No urgent tasks! You\'re all caught up.</div>';
      }
    }

    function renderStats() {
      const allTasks = Object.values(tasks);
      const total = allTasks.length;
      const completed = allTasks.filter(t => t.completed).length;
      const active = total - completed;
      const overdue = allTasks.filter(t => {
        const diff = getDaysDiff(t.due);
        return diff !== null && diff < 0 && !t.completed;
      }).length;

      document.getElementById('totalTasks').textContent = total;
      document.getElementById('completedTasks').textContent = completed;
      document.getElementById('activeTasks').textContent = active;
      document.getElementById('overdueStats').textContent = overdue;

      const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
      document.getElementById('completionRate').textContent = `${completionRate}% completion rate`;
      document.getElementById('completedBar').style.width = completionRate + '%';
      document.getElementById('activeBar').style.width = (total > 0 ? (active / total) * 100 : 0) + '%';

      quadrants.forEach(q => {
        const count = allTasks.filter(t => t.quadrant === q).length;
        const pct = total > 0 ? Math.round((count / total) * 100) : 0;
        const label = q.replace('-', '');
        document.getElementById(`${label}Stat`).textContent = count;
        document.getElementById(`${label}Bar`).style.width = pct + '%';
      });

      const insights = [];
      if (overdue > 0) {
        insights.push(`You have ${overdue} overdue task${overdue > 1 ? 's' : ''} that need immediate attention.`);
      }
      if (completionRate >= 70) {
        insights.push(`Great job! You're completing ${completionRate}% of your tasks.`);
      } else if (completionRate < 30 && total > 5) {
        insights.push(`Consider breaking down tasks into smaller, more manageable pieces.`);
      }
      
      const doFirstCount = allTasks.filter(t => t.quadrant === 'do-first').length;
      const eliminateCount = allTasks.filter(t => t.quadrant === 'eliminate').length;
      
      if (doFirstCount > total * 0.5 && total > 5) {
        insights.push(`Over half your tasks are in "Do First". Consider if some could be scheduled or delegated.`);
      }
      if (eliminateCount > 5) {
        insights.push(`You have ${eliminateCount} tasks in "Eliminate". Consider removing low-value items.`);
      }
      if (total === completed && total > 0) {
        insights.push(`All tasks completed! Time to set new goals.`);
      }
      if (insights.length === 0) {
        insights.push(`Keep adding tasks and tracking your progress to see personalized insights.`);
      }

      const insightsList = document.getElementById('insightsList');
      insightsList.innerHTML = insights.map(i => `<li>${i}</li>`).join('');
    }

    function showAuthSheet(show=true){
      if (show){ 
        authBackdrop.classList.add('show'); 
        authSheet.classList.add('show'); 
      } else { 
        authBackdrop.classList.remove('show'); 
        authSheet.classList.remove('show'); 
      }
    }
    
    authClose.addEventListener('click', ()=> {
      showAuthSheet(false);
      showApp(true);
    });

    authSend.addEventListener('click', ()=>{
      alert('Cloud sync is not available in this demo version. Your tasks are saved locally in your browser.');
      showAuthSheet(false);
      showApp(true);
    });

    function renderSubtasks() {
      if (!editingId) return;
      const task = tasks[editingId];
      if (!task) return;
      
      const subtasks = task.subtasks || [];
      subtasksList.innerHTML = '';
      
      subtasks.forEach((st, idx) => {
        const div = document.createElement('div');
        div.className = 'subtask' + (st.completed ? ' completed' : '');
        
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.checked = st.completed;
        checkbox.addEventListener('change', () => {
          task.subtasks[idx].completed = checkbox.checked;
          saveToStorage();
          renderSubtasks();
        });
        
        const text = document.createElement('span');
        text.textContent = st.text;
        text.style.flex = '1';
        
        const delBtn = document.createElement('button');
        delBtn.textContent = 'âœ•';
        delBtn.className = 'small-btn';
        delBtn.onclick = () => {
          task.subtasks.splice(idx, 1);
          saveToStorage();
          renderSubtasks();
        };
        
        div.appendChild(checkbox);
        div.appendChild(text);
        div.appendChild(delBtn);
        subtasksList.appendChild(div);
      });
    }

    addSubtaskBtn.addEventListener('click', () => {
      if (!editingId) return;
      const task = tasks[editingId];
      if (!task) return;
      
      const text = prompt('Subtask:');
      if (!text || !text.trim()) return;
      
      if (!task.subtasks) task.subtasks = [];
      task.subtasks.push({ text: text.trim(), completed: false });
      saveToStorage();
      renderSubtasks();
    });

    function createTaskNode(t){
      const div = document.createElement('div');
      div.className = 'task'; 
      div.dataset.id = t.id;
      if (t.completed) div.classList.add('completed');
      const urg = computeUrgencyClass(t.due);
      if (urg) div.classList.add(urg);

      const left = document.createElement('div'); 
      left.className='task-left';
      
      let titleHtml = `<div class="task-title">${escapeHtml(t.title)}`;
      if (t.label){
        if (t.label === 'client') titleHtml += ` <span class="tag tag-client">Client</span>`;
        if (t.label === 'personal') titleHtml += ` <span class="tag tag-personal">Personal</span>`;
        if (t.label === 'urgent') titleHtml += ` <span class="tag tag-urgent">Urgent</span>`;
      }
      titleHtml += `</div>`;
      
      let contentHtml = titleHtml;
      if (t.description) {
        contentHtml += `<div class="task-desc">${escapeHtml(t.description)}</div>`;
      }
      
      if (t.subtasks && t.subtasks.length > 0) {
        const completedSubs = t.subtasks.filter(s => s.completed).length;
        contentHtml += `<div style="font-size:0.85rem;color:var(--text-secondary);margin-top:4px">âœ“ ${completedSubs}/${t.subtasks.length} subtasks</div>`;
      }
      
      if (t.due) {
        contentHtml += `<div class="task-due">${escapeHtml(t.due)}</div>`;
      }
      
      left.innerHTML = contentHtml;

      const controls = document.createElement('div'); 
      controls.className='task-controls';
      
      const completeBtn = document.createElement('button'); 
      completeBtn.className='small-btn'; 
      completeBtn.textContent = t.completed ? 'â†º' : 'âœ”';
      completeBtn.title = t.completed ? 'Mark incomplete' : 'Mark complete';
      completeBtn.onclick = (e)=> { e.stopPropagation(); toggleComplete(t.id) };
      
      const editBtn = document.createElement('button'); 
      editBtn.className='small-btn'; 
      editBtn.textContent='âœŽ'; 
      editBtn.title='Edit'; 
      editBtn.onclick = (e)=> { e.stopPropagation(); openPanel(t.id) };
      
      const calBtn = document.createElement('button'); 
      calBtn.className='small-btn'; 
      calBtn.textContent='ðŸ“…'; 
      calBtn.title='Add to calendar'; 
      calBtn.onclick = (e)=> { 
        e.stopPropagation(); 
        if (t.due) {
          openGoogleCalendarFor(t);
        } else {
          alert('Please add a due date first');
        }
      };
      
      const delBtn = document.createElement('button'); 
      delBtn.className='small-btn'; 
      delBtn.textContent='âœ•'; 
      delBtn.title='Delete'; 
      delBtn.onclick = (e)=> { e.stopPropagation(); deleteTask(t.id) };

      controls.appendChild(completeBtn);
      controls.appendChild(editBtn);
      controls.appendChild(calBtn);
      controls.appendChild(delBtn);

      div.appendChild(controls);
      div.appendChild(left);

      div.draggable = true;
      div.addEventListener('dragstart', ()=> { 
        dragged = div; 
        setTimeout(()=>div.style.opacity='0.5',0); 
      });
      div.addEventListener('dragend', ()=> { 
        if (dragged) dragged.style.opacity='1'; 
        dragged=null; 
      });

      div.addEventListener('dblclick', ()=> openPanel(t.id));
      return div;
    }

    function render(){
      quadrants.forEach(q=>{
        const container = document.getElementById(`${q}-tasks`);
        if (!container) return;
        container.innerHTML = '';
        
        const list = Object.values(tasks).filter(t=>t.quadrant===q);
        list.sort((a,b)=>{
          if (a.due && b.due) return new Date(a.due) - new Date(b.due);
          if (a.due) return -1;
          if (b.due) return 1;
          return (a.createdAt || 0) - (b.createdAt || 0);
        });
        
        list.forEach(t=>{
          if (!matchesSearch(t)) return;
          const node = createTaskNode(t);
          if (!prefs.showCompleted && t.completed) {
            node.style.display = 'none';
          }
          container.appendChild(node);
        });
      });
      
      updateCounts(); 
      updateProgress(); 
      saveToStorage();
    }

    function matchesSearch(t){
      const term = (searchInput.value || '').trim().toLowerCase();
      if (!term) return true;
      const searchStr = (t.title + ' ' + (t.description||'') + ' ' + (t.due||'') + ' ' + (t.label||'')).toLowerCase();
      return searchStr.includes(term);
    }

    function addTaskFromFormQuick(){
      const title = taskTitle.value.trim();
      if (!title) { 
        taskTitle.focus(); 
        return; 
      }
      const id = uid();
      tasks[id] = {
        id,
        title,
        description: taskDesc.value.trim(),
        due: taskDue.value || '',
        quadrant: taskQuadrant.value || 'do-first',
        label: taskLabel.value || '',
        completed: false,
        subtasks: [],
        createdAt: Date.now()
      };
      taskTitle.value=''; 
      taskDesc.value=''; 
      taskDue.value=''; 
      taskQuadrant.value='do-first'; 
      taskLabel.value='';
      render();
      switchView(prefs.currentView);
    }

    function deleteTask(id){
      if (!confirm('Delete this task?')) return;
      delete tasks[id];
      render();
      switchView(prefs.currentView);
    }

    function toggleComplete(id){
      const t = tasks[id]; 
      if (!t) return;
      t.completed = !t.completed;
      render();
      switchView(prefs.currentView);
    }

    function openPanel(id){
      editingId = id;
      const t = tasks[id];
      if (!t) return;
      pTitle.value = t.title || '';
      pDesc.value = t.description || '';
      pDue.value = t.due || '';
      pQuadrant.value = t.quadrant || 'do-first';
      pLabel.value = t.label || '';
      pCompleted.checked = !!t.completed;
      document.getElementById('panelTitle').textContent = 'Edit task';
      renderSubtasks();
      showPanel(true);
    }
    
    function openPanelForNew(){
      editingId = null;
      pTitle.value=''; 
      pDesc.value=''; 
      pDue.value=''; 
      pQuadrant.value='do-first'; 
      pLabel.value=''; 
      pCompleted.checked=false;
      subtasksList.innerHTML = '';
      document.getElementById('panelTitle').textContent = 'New task';
      showPanel(true);
    }
    
    function showPanel(show){
      if (show){ 
        slidePanel.classList.add('show'); 
        panelBackdrop.classList.add('show'); 
        slidePanel.setAttribute('aria-hidden','false'); 
      } else { 
        slidePanel.classList.remove('show'); 
        panelBackdrop.classList.remove('show'); 
        slidePanel.setAttribute('aria-hidden','true'); 
        editingId = null; 
      }
    }
    
    panelCancel.addEventListener('click', ()=> showPanel(false));
    panelBackdrop.addEventListener('click', ()=> showPanel(false));

    panelSave.addEventListener('click', ()=>{
      if (!editingId){
        const id = uid();
        tasks[id] = { 
          id, 
          title: pTitle.value.trim() || 'Untitled', 
          description: pDesc.value.trim(), 
          due: pDue.value || '', 
          quadrant: pQuadrant.value || 'do-first', 
          label: pLabel.value || '', 
          completed: !!pCompleted.checked,
          subtasks: [],
          createdAt: Date.now() 
        };
      } else {
        const t = tasks[editingId]; 
        if (!t) return showPanel(false);
        t.title = pTitle.value.trim() || t.title;
        t.description = pDesc.value.trim();
        t.due = pDue.value || '';
        t.quadrant = pQuadrant.value;
        t.label = pLabel.value || '';
        t.completed = !!pCompleted.checked;
      }
      showPanel(false);
      render();
      switchView(prefs.currentView);
    });

    deleteFromPanelBtn.addEventListener('click', ()=>{
      if (!editingId) return;
      if (!confirm('Delete this task?')) return;
      delete tasks[editingId];
      showPanel(false);
      render();
      switchView(prefs.currentView);
    });

    document.querySelectorAll('.quadrant').forEach(qEl=>{
      qEl.addEventListener('dragover', e=> {
        e.preventDefault();
        qEl.style.background = 'rgba(9, 105, 218, 0.05)';
      });
      qEl.addEventListener('dragleave', ()=> {
        qEl.style.background = '';
      });
      qEl.addEventListener('drop', e=>{
        e.preventDefault();
        qEl.style.background = '';
        if (!dragged) return;
        const id = dragged.dataset.id;
        const target = qEl.dataset.q;
        if (tasks[id]) {
          tasks[id].quadrant = target;
          render();
        }
      });
    });

    function totalIn(q){ 
      return Object.values(tasks).filter(t=>t.quadrant===q).length 
    }
    function doneIn(q){ 
      return Object.values(tasks).filter(t=>t.quadrant===q && t.completed).length 
    }
    function updateCounts(){
      quadrants.forEach(q=>{
        const total = totalIn(q), done = doneIn(q);
        const el = document.getElementById(`${q}-count`);
        if (el) el.textContent = `(${done}/${total} done)`;
      });
    }
    function updateProgress(){
      quadrants.forEach(q=>{
        const total = totalIn(q), done = doneIn(q);
        const pct = total === 0 ? 0 : Math.round((done/total)*100);
        const fill = document.getElementById(`${q}-fill`);
        if (fill) fill.style.width = pct + '%';
      });
    }

    searchInput.addEventListener('input', ()=> render());
    
    toggleCompletedBtn.addEventListener('click', ()=>{
      prefs.showCompleted = !prefs.showCompleted;
      toggleCompletedBtn.textContent = prefs.showCompleted ? 'Hide Completed' : 'Show Completed';
      saveToStorage(); 
      render();
    });
    
    toggleCompletedBtn.textContent = prefs.showCompleted ? 'Hide Completed' : 'Show Completed';

    exportBtn.addEventListener('click', ()=>{
      const data = JSON.stringify({ tasks }, null, 2);
      const blob = new Blob([data], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); 
      a.href = url; 
      a.download = 'priobox-tasks.json';
      document.body.appendChild(a); 
      a.click(); 
      a.remove(); 
      URL.revokeObjectURL(url);
    });

    importBtn.addEventListener('click', ()=> importFileInput.click());
    
    importFileInput.addEventListener('change', (ev)=>{
      const f = ev.target.files[0];
      if (!f) return;
      const r = new FileReader();
      r.onload = ()=> {
        try {
          const obj = JSON.parse(r.result);
          if (obj.tasks){
            Object.values(obj.tasks).forEach(t=>{
              let    <option value="delegate">Delegate</option>
            <option value="eliminate">Eliminate</option>
          </select>
          <select id="taskLabel">
            <option value="">No label</option>
            <option value="client">Client</option>
            <option value="personal">Personal</option>
            <option value="urgent">Urgent</option>
          </select>
          <button class="btn" id="addBtn">Add Task</button>
          <button class="btn ghost" id="clearBtn">Clear All</button>
          <button class="btn ghost" id="demoBtn">Demo Data</button>
          <button id="exportBtn" class="btn ghost">Export</button>
          <button id="importBtn" class="btn ghost">Import</button>
        </section>

        <div class="search-row">
          <input id="searchInput" type="search" placeholder="Search tasks by title, description, due date, label..." />
        </div>

        <div class="filters">
          <button id="toggleCompletedBtn" style="height:36px;padding:8px 12px;border-radius:8px;background:var(--panel);border:1px solid var(--border);cursor:pointer">Hide Completed</button>
          <div style="font-size:0.9rem;color:var(--text-secondary)">Double-click to edit â€¢ Drag between quadrants</div>
        </div>

        <section class="matrix" aria-label="Priority matrix">
          <div class="quadrant do-first" data-q="do-first">
            <div class="quad-head">
              <div><div class="quad-title">Do First</div><div class="quad-sub">Urgent & Important</div></div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
                <div id="do-first-count">(0/0 done)</div>
                <div class="progress-bar"><div id="do-first-fill" class="progress-fill"></div></div>
              </div>
            </div>
            <div class="tasks" id="do-first-tasks" aria-live="polite"></div>
          </div>

          <div class="quadrant schedule" data-q="schedule">
            <div class="quad-head">
              <div><div class="quad-title">Schedule</div><div class="quad-sub">Not Urgent but Important</div></div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
                <div id="schedule-count">(0/0 done)</div>
                <div class="progress-bar"><div id="schedule-fill" class="progress-fill"></div></div>
              </div>
            </div>
            <div class="tasks" id="schedule-tasks"></div>
          </div>

          <div class="quadrant delegate" data-q="delegate">
            <div class="quad-head">
              <div><div class="quad-title">Delegate</div><div class="quad-sub">Urgent but Not Important</div></div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
                <div id="delegate-count">(0/0 done)</div>
                <div class="progress-bar"><div id="delegate-fill" class="progress-fill"></div></div>
              </div>
            </div>
            <div class="tasks" id="delegate-tasks"></div>
          </div>

          <div class="quadrant eliminate" data-q="eliminate">
            <div class="quad-head">
              <div><div class="quad-title">Eliminate</div><div class="quad-sub">Not Urgent & Not Important</div></div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
                <div id="eliminate-count">(0/0 done)</div>
                <div class="progress-bar"><div id="eliminate-fill" class="progress-fill"></div></div>
              </div>
            </div>
            <div class="tasks" id="eliminate-tasks"></div>
          </div>
        </section>
      </div>

      <footer>Â© 2025 PrioBox â€” Built by DGS Consulting</footer>
    </div>
  </div>

  <div id="panelBackdrop" class="panel-backdrop"></div>
  <aside id="slidePanel" class="panel" role="dialog" aria-hidden="true">
    <h3 id="panelTitle">Edit task</h3>
    <div class="row">
      <input id="pTitle" type="text" placeholder="Task title" />
    </div>
    <div class="row">
      <input id="pDue" type="date" />
      <select id="pQuadrant">
        <option value="do-first">Do First</option>
        <option value="schedule">Schedule</option>
